---
title: "NIP-66：中继发现和存活监控"
date: 2026-01-21
translationOf: /en/topics/nip-66.md
translationDate: 2026-01-28
draft: false
categories:
  - NIPs
  - Relays
---

NIP-66 标准化了将中继监控数据发布到 Nostr。监控服务持续测试中继的可用性、延迟、协议合规性和支持的 NIP，并将结果作为 kind 30166 事件发布。

## 工作原理

监控器通过连接和发送测试订阅来检查中继可用性。延迟测量跟踪连接时间、订阅响应时间和事件传播延迟。协议合规性测试验证中继行为是否符合规范，捕获实现错误或故意偏差。

NIP 支持验证不仅仅是 [NIP-11](/zh/topics/nip-11/) 声明，而是实际测试宣称的功能是否正常工作。如果中继声称支持 [NIP-50](/zh/topics/nip-50/) 搜索但搜索查询失败，监控器将从已验证列表中省略 NIP-50。这提供了关于中继功能的真实情况。

Kind 30166 事件使用中继 URL 作为 `d` 标签，使它们成为参数化可替换事件。每个监控器为每个中继发布一个事件，随着测量变化而更新。多个监控器可以跟踪同一个中继，提供冗余和交叉验证。

往返时间（rtt）标签测量不同操作的延迟：
- `rtt open`：WebSocket 连接建立
- `rtt read`：订阅响应时间
- `rtt write`：事件发布速度

所有值以毫秒为单位。客户端使用这些指标来为时间敏感的操作优先选择低延迟中继。

地理信息帮助客户端选择附近的中继以获得更好的延迟和抗审查能力。`geo` 标签包含国家代码、国家名称和地区。`network` 标签区分明网中继与 Tor 隐藏服务或 I2P 端点。

## 用例

监控数据为客户端中的中继选择器、浏览网站和信任评估系统提供支持。通过提供独立于中继自我报告的实时中继状态，NIP-66 实现了知情的中继选择。

结合 [NIP-11](/zh/topics/nip-11/)（自我报告的功能）和可信中继声明（信任评估），生态系统正在向数据驱动的中继选择发展，而不是依赖硬编码的默认值。

---

**主要来源：**
- [NIP-66 规范](https://github.com/nostr-protocol/nips/blob/master/66.md) - 中继发现和存活监控标准

**提及于：**
- [通讯 #6：NIP 深入分析](/zh/newsletters/2026-01-21-newsletter/#nip-deep-dive-nip-11-and-nip-66)

**另请参阅：**
- [NIP-11：中继信息文档](/zh/topics/nip-11/)
- [可信中继声明](/zh/topics/trusted-relay-assertions/)
