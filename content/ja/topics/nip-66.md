---
title: "NIP-66: リレー発見と稼働監視"
date: 2026-01-21
translationOf: /en/topics/nip-66.md
translationDate: 2026-01-28
draft: false
categories:
  - NIPs
  - Relays
---

NIP-66は、リレー監視データをNostrに公開するための標準を定めています。監視サービスはリレーの可用性、レイテンシ、プロトコル準拠、サポートされているNIPを継続的にテストし、結果をkind 30166イベントとして公開します。

## 仕組み

監視サービスは、接続してテストサブスクリプションを送信することでリレーの可用性をチェックします。レイテンシ測定は、接続時間、サブスクリプション応答時間、イベント伝播遅延を追跡します。プロトコル準拠テストは、リレーの動作が仕様に一致するかを検証し、実装のバグや意図的な逸脱を検出します。

NIPサポートの検証は、[NIP-11](/ja/topics/nip-11/)の主張を超えて、宣伝された機能が実際に正しく動作するかをテストします。リレーが[NIP-50](/ja/topics/nip-50/)検索サポートを主張しているが検索クエリが失敗する場合、監視サービスは検証済みリストからNIP-50を省略します。これにより、リレー機能に関する真実のデータが提供されます。

Kind 30166イベントは`d`タグとしてリレーURLを使用し、パラメータ化された置換可能イベントにします。各監視サービスはリレーごとに1つのイベントを公開し、測定値が変わると更新します。複数の監視サービスが同じリレーを追跡でき、冗長性と相互検証を提供します。

ラウンドトリップタイム（rtt）タグは、異なる操作のレイテンシを測定します：
- `rtt open`: WebSocket接続確立
- `rtt read`: サブスクリプション応答時間
- `rtt write`: イベント公開速度

すべての値はミリ秒単位です。クライアントはこれらのメトリクスを使用して、時間に敏感な操作に低レイテンシのリレーを優先します。

地理情報は、クライアントがより良いレイテンシと検閲耐性のために近くのリレーを選択するのに役立ちます。`geo`タグには国コード、国名、地域が含まれます。`network`タグは、クリアネットリレーとTor隠れサービスやI2Pエンドポイントを区別します。

## ユースケース

監視データは、クライアントのリレーセレクター、エクスプローラーWebサイト、信頼評価システムに力を与えます。リレーの自己報告に依存せずにリアルタイムのリレーステータスを提供することで、NIP-66は情報に基づいたリレー選択を可能にします。

[NIP-11](/ja/topics/nip-11/)（自己報告された機能）とTrusted Relay Assertions（信頼評価）と組み合わせることで、エコシステムはハードコードされたデフォルトに依存するのではなく、データ駆動型のリレー選択に向かっています。

---

**主要な出典：**
- [NIP-66仕様](https://github.com/nostr-protocol/nips/blob/master/66.md) - リレー発見と稼働監視標準

**言及先：**
- [ニュースレター#6: NIPディープダイブ](/ja/newsletters/2026-01-21-newsletter/#nip-deep-dive-nip-11-and-nip-66)

**関連項目：**
- [NIP-11: リレー情報ドキュメント](/ja/topics/nip-11/)
- [Trusted Relay Assertions](/ja/topics/trusted-relay-assertions/)
